1
00:00:02,120 --> 00:00:04,210
现在添加注销功能

2
00:00:04,210 --> 00:00:05,230
在标题中，

3
00:00:05,230 --> 00:00:07,140
我将添加另一个列表项

4
00:00:08,150 --> 00:00:10,513
里面有一个基本按钮，

5
00:00:12,000 --> 00:00:13,323
我在哪里说，

6
00:00:14,690 --> 00:00:15,573
登出。

7
00:00:18,370 --> 00:00:21,295
给我们这个按钮

8
00:00:21,295 --> 00:00:23,390
然后按钮应该做它所说的。

9
00:00:23,390 --> 00:00:25,010
它应该让我们退出。

10
00:00:25,010 --> 00:00:27,210
当然这个列表项应该只可见

11
00:00:27,210 --> 00:00:28,880
如果我们被锁在里面，

12
00:00:28,880 --> 00:00:31,540
因为显示注销按钮没有意义，

13
00:00:31,540 --> 00:00:32,993
如果我们没有被锁定。

14
00:00:33,900 --> 00:00:35,680
现在我们需要添加一个新动作，

15
00:00:35,680 --> 00:00:37,620
这就是注销操作。

16
00:00:37,620 --> 00:00:40,950
因此，在操作文件的 off 模块中，

17
00:00:40,950 --> 00:00:42,780
我添加了一个注销操作。

18
00:00:42,780 --> 00:00:45,500
现在注销真的很简单。

19
00:00:45,500 --> 00:00:47,790
我们不需要发送任何请求

20
00:00:47,790 --> 00:00:50,570
因为你可能记得我说过服务器

21
00:00:50,570 --> 00:00:53,920
无论如何都不会存储有关我们的任何信息。

22
00:00:53,920 --> 00:00:56,760
所以没有必要发送请求。

23
00:00:56,760 --> 00:00:58,610
相反，我们唯一要做的

24
00:00:58,610 --> 00:01:01,230
清楚这里的所有数据，

25
00:01:01,230 --> 00:01:02,683
将其设置回 null。

26
00:01:04,269 --> 00:01:06,350
因此，我们得到了我们的状态

27
00:01:06,350 --> 00:01:09,870
我们可以简单地将状态令牌设置为null，

28
00:01:09,870 --> 00:01:12,920
状态用户 ID 并设置为 null，

29
00:01:12,920 --> 00:01:17,190
和状态令牌到期并将其设置为空。

30
00:01:17,190 --> 00:01:18,920
这就是我们要做的。

31
00:01:18,920 --> 00:01:20,240
现在，因为我们，例如，

32
00:01:20,240 --> 00:01:22,360
检查我们是否经过身份验证的头部集合，

33
00:01:22,360 --> 00:01:23,910
我们是否有令牌，

34
00:01:23,910 --> 00:01:26,650
我们将把经过身份验证的标头设置为 false。

35
00:01:26,650 --> 00:01:28,500
一旦我们将令牌设置为空，

36
00:01:28,500 --> 00:01:31,540
因为那是一个无效的令牌。

37
00:01:31,540 --> 00:01:32,373
当然，现在，

38
00:01:32,373 --> 00:01:34,280
这不是这样做的有效方式。

39
00:01:34,280 --> 00:01:36,610
那是一个动作，而不是一个突变，

40
00:01:36,610 --> 00:01:38,980
我们已经有了一个突变集用户。

41
00:01:38,980 --> 00:01:41,450
最后，我们正在设置自由字段

42
00:01:41,450 --> 00:01:42,930
我们想要重置。

43
00:01:42,930 --> 00:01:44,560
所以我们只需要传递一个有效载荷

44
00:01:44,560 --> 00:01:47,700
所有这些字段的值为空。

45
00:01:47,700 --> 00:01:49,690
所以在注销时，动作，

46
00:01:49,690 --> 00:01:51,690
我们实际上得到了状态的上下文

47
00:01:52,850 --> 00:01:56,290
但是在这里我们应该简单地上下文提交，

48
00:01:56,290 --> 00:01:57,940
设置用户，

49
00:01:57,940 --> 00:02:00,760
并传入我们的有效载荷对象，

50
00:02:00,760 --> 00:02:03,470
其中令牌为空，

51
00:02:03,470 --> 00:02:05,570
用户 ID 为空，

52
00:02:05,570 --> 00:02:07,440
并且令牌过期为空

53
00:02:07,440 --> 00:02:10,130
与刚才解释的原因相同。

54
00:02:10,130 --> 00:02:12,073
现在这是一种正确的做法。

55
00:02:13,430 --> 00:02:17,110
并且在标题中添加了该操作，

56
00:02:17,110 --> 00:02:19,480
我们可以添加一个点击监听器

57
00:02:19,480 --> 00:02:21,610
到这个注销按钮

58
00:02:21,610 --> 00:02:24,140
然后在我们的脚本中添加方法

59
00:02:24,140 --> 00:02:26,300
并添加注销方法

60
00:02:26,300 --> 00:02:28,940
我们在哪里联系我们的商店

61
00:02:28,940 --> 00:02:31,793
并发送了此注销操作。

62
00:02:33,360 --> 00:02:37,233
现在这个注销方法可以连接到这个按钮了。

63
00:02:38,720 --> 00:02:41,730
如果我们在重新加载后这样做，

64
00:02:41,730 --> 00:02:43,933
我们可以登录，

65
00:02:45,650 --> 00:02:47,940
假设使用 test2 用户

66
00:02:48,840 --> 00:02:50,640
像这样

67
00:02:50,640 --> 00:02:54,010
现在在所有教练上，我们也看到注册为教练按钮

68
00:02:54,010 --> 00:02:57,390
因为这个用户还没有注册。

69
00:02:57,390 --> 00:03:01,200
我们可以去请求，我们可以点击注销

70
00:03:01,200 --> 00:03:03,560
我们看到了更新。

71
00:03:03,560 --> 00:03:05,640
现在，一件事不会更新

72
00:03:05,640 --> 00:03:09,020
无论是当我们注销时，还是当我们登录时，

73
00:03:09,020 --> 00:03:11,440
是我们所在的页面。

74
00:03:11,440 --> 00:03:13,870
现在，如果我们确实登录，那就太好了

75
00:03:13,870 --> 00:03:15,610
如果我们会被重定向

76
00:03:15,610 --> 00:03:18,470
例如，回到教练的页面。

77
00:03:18,470 --> 00:03:21,230
如果我们确实退出并且我正在接受请求，

78
00:03:21,230 --> 00:03:22,640
可能会很好，

79
00:03:22,640 --> 00:03:25,720
因为我在技术上不能再去请求了，

80
00:03:25,720 --> 00:03:28,810
如果我都这样做了，就会被重定向到其他地方。

81
00:03:28,810 --> 00:03:30,080
所以让我们努力吧

82
00:03:30,080 --> 00:03:32,793
接下来的路由和重定向部分。